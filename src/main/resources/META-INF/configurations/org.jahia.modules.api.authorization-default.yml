- scope: graphql
  description: Can access graphql API
  contexts: hosted-context
  grants:
    - api:
        include: graphql
        exclude: graphql.Query.admin

- scope: graphql-privileged
  description: Can access graphql API (privileged users)
  contexts: hosted-context
  user:
    privileged: true
  grants:
    - api: graphql

- scope: access-category
  description: Can access category tree
  contexts: hosted-context
  grants:
    - node:
        nodeType: jnt:category

- scope: site-tree
  description: Can access site tree
  contexts: hosted-context
  grants:
    - api: view.json.treeRootItem
      node:
        nodeType: jnt:virtualsite
        pathPattern: /sites/.*
    - api: view.json.treeItem, view.json.tree
      node:
        nodeType: jnt:folder, jnt:page, jnt:portlet, jnt:navMenuText
        pathPattern: /sites/.*

- scope: html_views
  description: Can access HTML views
  contexts: hosted-context
  grants:
    - api: view.html

- scope: deploy_modules
  description: Can manage modules deployment
  user:
    permission:
      - name: adminTemplates
      - path: /
  grants:
    - api: provisioning
    - api: module_manager
