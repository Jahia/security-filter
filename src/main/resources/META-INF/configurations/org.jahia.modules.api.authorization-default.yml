- scope: graphql
  description: Can access graphql API
  auto_apply:
    - origin: hosted
  grants:
    - api:
        include: graphql
        exclude: graphql.Query.admin

- scope: graphql-privileged
  description: Can access graphql API (privileged users)
  auto_apply:
    - origin: hosted
  constraints:
    - privileged_user: true
  grants:
    - api: graphql

- scope: access-category
  description: Can access category tree
  apply_on:
    - origin: hosted
  grants:
    - node:
        nodeType: jnt:category

- scope: site-tree
  description: Can access site tree
  auto_apply:
    - origin: hosted
  grants:
    - api: view.json.treeRootItem
      node:
        nodeType: jnt:virtualsite
        pathPattern: /sites/.*
    - api: view.json.treeItem, view.json.tree
      node:
        nodeType: jnt:folder, jnt:page, jnt:portlet, jnt:navMenuText
        pathPattern: /sites/.*

- scope: html_views
  description: Can access HTML views
  auto_apply:
    - origin: hosted
  grants:
    - api: view.html
      node:

- scope: deploy_modules
  description: Can manage modules deployment
  constraints:
    - user_permission: adminTemplates
      path: /
  grants:
    - api: provisioning
    - api: module_manager
